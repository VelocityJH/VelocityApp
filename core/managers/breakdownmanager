import Foundation
import SwiftUI

class BreakdownManager: ObservableObject {
    static let shared = BreakdownManager()

    @Published var openBreakdowns: [Breakdown] = []

    private init() {}

    func addBreakdown(_ breakdown: Breakdown) {
        openBreakdowns.append(breakdown)
    }

    func joinJob(_ breakdownID: UUID, engineer: String) {
        guard let index = openBreakdowns.firstIndex(where: { $0.id == breakdownID }) else { return }
        if !openBreakdowns[index].joinedEngineers.contains(engineer) {
            openBreakdowns[index].joinedEngineers.append(engineer)
        }
    }

    func endJob(_ breakdownID: UUID) {
        openBreakdowns.removeAll { $0.id == breakdownID }
    }
}